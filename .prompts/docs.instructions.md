# Documentation

> This file contains high level documentation for the project. It is not meant to be a comprehensive guide, but rather a quick reference for developers, contribution and AI.

This is premium Nuxt.js boilerplate. Goal is to provide a solid foundation for building SaaS applications with Nuxt.js, Nitro, and Drizzle ORM.

Project should be easy to understand, extend, modular and maintain. It should also be performant and secure.

## Technologies Used

> _Please refer to package.json file for a complete list of dependencies._

## Directory Structure

> _As we're using Nuxt.js, the directory structure follows its conventions._

Below is some custom conventions we developed:

- Schemas, Types, Utilities, constants, etc which are shared between client (nuxt) and server (nitro) are placed in `shared` directory.
- Under `app/layouts` directory we have `blank.vue` layout for pages that don't require application layout. This is useful for pages like login, signup, etc. For the rest of the pages we use `default.vue` layout as default layout.
- We have `server/database` directory for all database related code.
  - `crud` directory contains CRUD operations for each table.
  - `migrations` directory contains database migrations generated by Drizzle ORM. We shouldn't touch that.
  - `schema` directory contains table schema definitions.
    - `schema/mixins.ts` contains mixins for common table fields like `created_at`, `updated_at`, etc.

## Features

- Docker support for development and production.

### Authentication

- Auth Mechanism we're going to provide
  - Mandatory or optional Email verification based on config defined in `nuxt.config.ts` file.
    - If email verification is required, after sign in user have to verify their email before they can access the application.
    - If email verification is not required, user can access the application immediately after sign in.
  - Credentials based sign in.
    - Reset password via email.
    - Forgot password via email.
  - Magic link sign in.
  - Social auth via OAuth providers using Google, GitHub, Apple, and X.
  - Account linking for social accounts after sign in.
  - At the end, we're only going to allow either magic link sign in or password based sign in. We won't allow both at the same time. However, there can be social accounts sign in along with magic link or password based sign in.
- Only admin can ban or lift ban on users.
- We'll maintain various tokens in `tokens` table.
  - `magic_link` token for magic link sign in.
  - `reset_password` token for reset password flow.
  - `forgot_password` token for forgot password flow.
  - `email_verification` token for email verification flow.
  - more tokens can be added in future as needed.
- Only admin can impersonate users.
- Users can deactivate their own accounts, which will be reactivated on next sign in.
- Users can link their social accounts to their account.
- User can have multiple account types like password, magic link, social auth, etc linked to single user record.
- Roles and permissions will be dynamically managed via the admin panel and stored in the database.

### Storage

- Upload files to
  - Local storage
  - S3 compatible storage
  - Cloudflare R2
  - Vercel Blob Storage
  - Digital Ocean Spaces

### Payments

- [ ] Support payment providers
  - [ ] Polar
  - [ ] Stripe
  - [ ] LemonSqueezy
  - [ ] Paddle

### Projects & Teams

- Projects and Workspaces are same. Teams and Organizations are same.
- Projects allows users to create and manage multiple projects.
- Teams allows users to collaborate on projects.
- User can create multiple projects and teams, invite other users to join their projects and teams, assign roles and permissions to users, and manage project settings.

### Admin Panel

- Admin panel allows admin to manage whole application.
- Admin can manage users, projects, teams, roles, permissions, and other application settings.
- Admin can manage payment related stuff like subscriptions, invoices, and payment methods.

## Authentication & Authorization

### User Flow Decisions

- We should send API endpoint URL for verification email instead of frontend URL.
- We'll NOT autolink accounts if user first logs in with credentials and then sign in with social auth having same mail. Instead, We'll show helpful message to user. User will have to link accounts manually after sign in.

## Email Providers

- [ ] Support email providers
  - [-] Resend
  - [-] Amazon SES
  - [-] SendGrid
  - [-] Mailgun
  - [-] Postmark
  - [x] SMTP

## Future Plans & ToDos

- [ ] Considering `banned_at` in existing auth flow.
- [ ] Implement user roles and permissions via `nuxt-authorization` module.
- [ ] AI centric features
  - [ ] Simple AI chat interface
- [ ] More Auth Mechanism
  - [ ] Passkeys (WebAuthn) sign in with face id or fingerprint.
  - 2FA via email, SMS or authenticator app.
- [ ] More database support
  - [ ] NuxtHub - Cloudflare D1
  - [ ] Turso
  - [ ] Neon
  - [ ] Vercel Postgres
- [ ] Newsletter
  - Send email newsletters to users from admin panel.
  - [ ] Support newsletter providers
    - [ ] Mailchimp
    - [ ] ConvertKit
    - [ ] Substack
