name: ğŸš€ Release
run-name: âœ¨ Release ${{ github.ref_name }}

on:
  push:
    tags:
      - 'v*.*.*'

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      GitHubPersonalToken: ${{ secrets.GH_PAT }}
    steps:
      # It converts all secrets to environment variables for subsequent steps.
      - name: ğŸ¤« Expose GitHub Secrets as Environment Variables for zod validation & usage
        run: |
          echo "Converting secrets to environment variables..."
          # The toJSON(secrets) function serializes the secrets context into a JSON string.
          # We pipe this to jq to parse it. For each key-value pair, it prints "KEY=VALUE".
          # This output is then appended to the $GITHUB_ENV file.
          # The runner automatically picks up these variables for all following steps.
          echo '${{ toJSON(secrets) }}' | jq -r 'to_entries|map("\(.key)=\(.value)")|.[]' >> $GITHUB_ENV
          echo "Secrets exposed."

      - name: âš™ï¸ Setup pnpm
        uses: pnpm/action-setup@v4

      - name: â¬‡ï¸ Checkout template
        uses: actions/checkout@v4

      - name: ğŸš€ Release
        run: gh release create ${{ github.ref_name }} --title "Release ${{ github.ref_name }}" --notes "Please refer to live [changelog](${{ vars.WEBSITE_URL }}/docs/resources/changelog) for details." --verify-tag
